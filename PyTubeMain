from pytube import YouTube
from pytube import Playlist

#where to save
SAVE_PATH = {"Videos": "E:/YouTube" , "Playlist":"E:/YouTubePlayList"}

#links of the video to be downloaded
links=["https://www.youtube.com/watch?v=GC80Dk7eg_A&ab_channel=Cisco",

"https://youtube.com/playlist?list=PLblh5JKOoLUL3IJ4-yor0HzkqDQ3JmJkc"]

def LetsDownload(SAVE_PATH):

	# object creation using YouTube which was imported in the beginning
	yt = YouTube(link)
	d_video = yt.streams.filter(progressive=True, file_extension='mp4').order_by('resolution').desc().first()
	d_video.download(SAVE_PATH)
  
n=0

for link in links:

	if "playlist" in link:

		playlist = Playlist(link)
		PlaylistPath= SAVE_PATH["Playlist"]
		PlayListLinks = playlist.video_urls
		N = len(PlayListLinks)
		#print('Number of videos in playlist: %s' % len(PlayListLinks))
		print(f"This link found to be a Playlist Link with number of videos equal to {N} ")
		print(f"\n Lets Download all {N} videos")

		for i,link in enumerate(PlayListLinks):

			LetsDownload(PlaylistPath)
			print(i+1, ' Video is Downloaded.')

	else:
  
		VideosPath= SAVE_PATH["Videos"]
		print("This link found to be a Video Link")
		LetsDownload(VideosPath)
		n=n+1
		print(n, ' Video is Downloaded.')
